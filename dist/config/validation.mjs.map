{
  "version": 3,
  "sources": ["../../src/config/validation.mts"],
  "sourcesContent": ["/*\n * Copyright (c) 2022 Kiyozz.\n *\n * All rights reserved.\n */\n\nimport Joi from 'joi'\n\nimport { Logger } from '../console.mjs'\nimport { EnvConfig } from './config.mjs'\nimport { TypeConfig } from './enums.mjs'\nimport { Yaml, YamlSkeleton } from './yaml.mjs'\n\nconst _logger = new Logger('Config/Validation')\nconst _schema = Joi.object<YamlSkeleton>({\n  mainConfig: Joi.object({\n    type: Joi.string().valid(TypeConfig.esbuild).required(),\n    path: Joi.string().required(),\n    src: Joi.string().required(),\n    output: Joi.string().required(),\n  }).required(),\n  rendererConfig: Joi.object({\n    type: Joi.string()\n      .valid(TypeConfig.esbuild, TypeConfig.webpack, TypeConfig.vite)\n      .required(),\n    path: Joi.string().required(),\n    src: Joi.string().required(),\n    output: Joi.string().required(),\n    html: Joi.string().optional(),\n  })\n    .optional()\n    .allow(null),\n})\n\nexport class ConfigFile {\n  constructor(public readonly config: YamlSkeleton) {\n    if (this.config.rendererConfig === undefined) {\n      this.config.rendererConfig = null\n    }\n  }\n\n  ensureValid(): true | never {\n    const result = _schema.validate(this.config)\n\n    if (result.error) {\n      return _logger.end(\n        'Configuration file contains errors,',\n        result.error.details.map((item) => item.message).join('; '),\n      )\n    }\n\n    return true\n  }\n\n  toYaml(): Yaml {\n    return new Yaml({\n      main: EnvConfig.fromYaml(this.config.mainConfig),\n      renderer:\n        this.config.rendererConfig !== null\n          ? EnvConfig.fromYaml(this.config.rendererConfig)\n          : null,\n    })\n  }\n}\n"],
  "mappings": "AAMA;AAEA;AACA;AACA;AACA;AAEA,MAAM,UAAU,IAAI,OAAO,mBAAmB;AAC9C,MAAM,UAAU,IAAI,OAAqB;AAAA,EACvC,YAAY,IAAI,OAAO;AAAA,IACrB,MAAM,IAAI,OAAO,EAAE,MAAM,WAAW,OAAO,EAAE,SAAS;AAAA,IACtD,MAAM,IAAI,OAAO,EAAE,SAAS;AAAA,IAC5B,KAAK,IAAI,OAAO,EAAE,SAAS;AAAA,IAC3B,QAAQ,IAAI,OAAO,EAAE,SAAS;AAAA,EAChC,CAAC,EAAE,SAAS;AAAA,EACZ,gBAAgB,IAAI,OAAO;AAAA,IACzB,MAAM,IAAI,OAAO,EACd,MAAM,WAAW,SAAS,WAAW,SAAS,WAAW,IAAI,EAC7D,SAAS;AAAA,IACZ,MAAM,IAAI,OAAO,EAAE,SAAS;AAAA,IAC5B,KAAK,IAAI,OAAO,EAAE,SAAS;AAAA,IAC3B,QAAQ,IAAI,OAAO,EAAE,SAAS;AAAA,IAC9B,MAAM,IAAI,OAAO,EAAE,SAAS;AAAA,EAC9B,CAAC,EACE,SAAS,EACT,MAAM,IAAI;AACf,CAAC;AAEM,MAAM,WAAW;AAAA,EACtB,YAA4B,QAAsB;AAAtB;AAC1B,QAAI,KAAK,OAAO,mBAAmB,QAAW;AAC5C,WAAK,OAAO,iBAAiB;AAAA,IAC/B;AAAA,EACF;AAAA,EAEA,cAA4B;AAC1B,UAAM,SAAS,QAAQ,SAAS,KAAK,MAAM;AAE3C,QAAI,OAAO,OAAO;AAChB,aAAO,QAAQ,IACb,uCACA,OAAO,MAAM,QAAQ,IAAI,CAAC,SAAS,KAAK,OAAO,EAAE,KAAK,IAAI,CAC5D;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,SAAe;AACb,WAAO,IAAI,KAAK;AAAA,MACd,MAAM,UAAU,SAAS,KAAK,OAAO,UAAU;AAAA,MAC/C,UACE,KAAK,OAAO,mBAAmB,OAC3B,UAAU,SAAS,KAAK,OAAO,cAAc,IAC7C;AAAA,IACR,CAAC;AAAA,EACH;AACF;",
  "names": []
}
